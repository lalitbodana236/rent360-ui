<ng-container *ngIf="data as vm">
  <div class="r360-page">
    <r360-page-header [title]="'Good Morning, ' + userName" subtitle="Role-based overview"></r360-page-header>

    <section class="r360-section">
      <h2 class="mb-4 text-2xl font-semibold">{{ viewLabel }}</h2>
      <div class="grid grid-cols-1 gap-4 lg:grid-cols-2 xl:grid-cols-4">
        <r360-card *ngFor="let kpi of vm.kpis" class="block transition-shadow hover:shadow-md">
          <div class="mb-2 text-xs uppercase tracking-wide text-gray-500">{{ kpi.label }}</div>
          <div class="text-4xl font-bold text-gray-900 dark:text-gray-100">{{ kpi.value }}</div>
        </r360-card>
      </div>
    </section>

    <section class="grid grid-cols-1 gap-4 xl:grid-cols-5">
      <r360-card class="block xl:col-span-2">
        <h3 class="mb-6 text-xl font-semibold">Payments Overview</h3>
        <div *ngFor="let row of vm.collectionHealth" class="mb-5 last:mb-0">
          <div class="mb-2 flex items-center justify-between text-sm">
            <span>{{ row.label }}</span>
            <span>{{ row.percent }}%</span>
          </div>
          <div class="h-2 overflow-hidden rounded-lg bg-gray-200 dark:bg-gray-700">
            <div
              class="h-full rounded-lg"
              [ngClass]="[
                widthClass(row.percent),
                row.tone === 'success' ? 'bg-success' : '',
                row.tone === 'info' ? 'bg-secondary' : '',
                row.tone === 'warning' ? 'bg-warning' : '',
                row.tone === 'danger' ? 'bg-danger' : ''
              ]"
            ></div>
          </div>
        </div>
      </r360-card>

      <r360-card class="block xl:col-span-3">
        <div class="mb-6 flex items-center justify-between">
          <h3 class="text-xl font-semibold">{{ chargesTitle }}</h3>
          <r360-pagination></r360-pagination>
        </div>
        <r360-table>
          <thead>
            <tr class="border-b border-gray-200 dark:border-gray-700">
              <th class="r360-th">Amount</th>
              <th class="r360-th">Property</th>
              <th class="r360-th">Unit</th>
              <th class="r360-th">Description</th>
              <th class="r360-th">Status</th>
              <th class="r360-th">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let c of vm.charges" class="r360-row">
              <td class="r360-td">{{ c.amount }}</td>
              <td class="r360-td">{{ c.property }}</td>
              <td class="r360-td">{{ c.unit }}</td>
              <td class="r360-td">{{ c.description }}</td>
              <td class="r360-td"><r360-status-badge [value]="c.status"></r360-status-badge></td>
              <td class="r360-td"><a class="font-semibold text-secondary" href="#">{{ c.action }}</a></td>
            </tr>
          </tbody>
        </r360-table>
      </r360-card>
    </section>
  </div>
</ng-container>
